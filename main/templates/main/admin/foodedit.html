{% extends '../admin-layout.html' %}

{% block title %}
Edit
{% endblock %}

{% block stylesheets %}
<style>
    .cat:focus {
        border-color: #ff9f43;
        outline: 0;
        -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, .6);
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, .6)
    }

    #id_image {
        border: 1px solid #ccc;
        display: inline-block;
        padding: 6px 12px;
        cursor: pointer;
    }

</style>
{% endblock stylesheets %}

{% block content %}
<div class="content">
    <div class="page-header">
        <div class="page-title">
            <h4>Edit Food</h4>
            <!-- <h6>Create your food item</h6> -->
        </div>
    </div>
    <div class="card">
        <div class="card-body">

            <form action="" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="form-group">
                            <label>Food</label>
                            <input type="text" value="{{ food.name }}" class="form-control" name="food" required>
                        </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 col-12">
                        <div class="form-group">
                            <label>Category</label>
                            <select class="select2 cat form-select" name="cat_id" class="form-control" required>
                                <option selected value="{{food.category}}">{{ food.category }}</option>
                                {% for c in cat %}
                                <option value="{{ c }}">{{ c.category_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="form-group">
                            <label>Price</label>
                            <input type="number" value="{{ food.price }}" class="form-control" name="price" required>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="form-group">
                            <label>Estimated Preparation Time</label>
                            <input type="text" class="form-control" value="{{ food.PrepTime }}" name="ept" required>

                        </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                        <div class="form-group">
                            <label>Description</label>
                            {{ form.description }}
                        </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                        <table class="table" id="dynamic_field">
                            <tr>
                                <div class="form-group">
                                    <label>Photos Images:</label>
                                    <td>{{ form.image }}</td>
                                </div>
                            </tr>
                        </table>
                    </div>
                    <div class="col-lg-12">
                        <button type="submit" class="btn btn-submit me-2">Update</button>
                        <a onclick="window.history.go(-1); return false;" class="btn btn-cancel">Cancel</a>
                    </div>
                </div>
            </form>

        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
    $(function () {
        //Initialize Select2 Elements
        $('.select2').select2();
    });
</script>
<script>
    $(document).ready(function () {
        var i = 1;
        $('#add').click(function () {
            i++;
            $('#dynamic_field').append('<tr id="row' + i + '"><td><input multiple type="file" name="p_photo[]" placeholder="Photos" class="form-control name_list" required accept="image/*" /></td></td> <td><button id="' + i + '" class="btn btn-danger btn_remove">X</button></td></tr>');
        });
        $(document).on('click', '.btn_remove', function () {
            var button_id = $(this).attr("id");
            $('#row' + button_id + '').remove();
        });
        $('#submit').click(function () {
            $.ajax({
                url: form.attr("action"),
                method: "POST",
                data: $("#myForm input").serialize(),
                success: function (data) {
                    console.log(data);
                    $('#myForm input')[0].reset();
                }
            });
        });
    });
</script>
{% endblock javascripts %}
